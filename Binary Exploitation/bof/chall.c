#include <stdio.h>
#include <stdlib.h>

// gcc -fno-stack-protector -no-pie chall.c

void ignore_me_just_init_buffering()
{
    setvbuf(stdin , NULL, _IONBF, 0);
    setvbuf(stdout, NULL, _IONBF, 0);
    setvbuf(stderr, NULL, _IONBF, 0);
}

int main()
{
    ignore_me_just_init_buffering();
    
    // START HERE
    size_t overflow_me = 0; 
    char buf[0x40];

    printf("< This is simple buffer overflow vulnerability.\n");
    printf("< You have to change value of `overflow_me` variable with this bug.\n");
    printf("< On `Buffer Overflow 2` you have to change value to 0xdeadbeef.\n");
    printf("< First, `overflow_me` is set to 0x%lx.\n", overflow_me);
    printf("< Now, time is yours!\n");
    printf("> ");

    gets(buf);

    printf("< %s\n", buf);
    printf("< Now `overflow_me` is 0x%lx\n", overflow_me);

    if (overflow_me > 0)
    {
        printf("< Nice work! `overflow_me` has changed!\n");
        if (overflow_me == 0xdeadbeef) {
            system("cat flag_bof_2.txt");
        } else {
            system("cat flag_bof_1.txt");
        }
    }
    return 0;
}